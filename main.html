<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Forensische ICT Opdracht</title>
  <style>
    /* Globale box-sizing regel */
    *, *::before, *::after {
      box-sizing: border-box;
    }
    /* Basisstijl (licht thema) */
    body {
      background-color: #f0f0f0;
      color: #333;
      font-family: Arial, sans-serif;
      transition: background-color 0.3s, color 0.3s;
      padding: 20px;
      margin: 0;
    }
    /* Dark mode stijlen */
    body.dark-mode {
      background-color: #121212;
      color: #e0e0e0;
    }
    /* Laadanimatie styling */
    #loader {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1000;
    }
    .spinner {
      border: 8px solid #f3f3f3;
      border-top: 8px solid #007bff;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    /* Verberg de applicatie tot darkmode en Pyodide geladen is */
    #main-container {
      display: none;
      margin-left: 20px;
      margin-right: 20px;
      width: 99%;
    }
    /* Overige styling */
    #header-container {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
      width: 100%;
    }
    #header-text {
      flex: 1;
      text-align: left;
    }
    #header-container h1 {
      margin: 0;
      padding: 0;
    }
    #difficulty {
      font-size: 0.9em;
      font-weight: bold;
      color: white;
      background-color: #28a745;
      display: inline-block;
      padding: 5px 15px;
      border-radius: 5px;
      margin-top: 10px;
    }
    #assignment-description {
      margin-top: 10px;
    }
    #button-container {
      text-align: left;
      margin-bottom: 10px;
    }
    #terminal-container {
      text-align: left;
    }
    #toolbar {
      background-color: #f5f5f5;
      border: 1px solid #ccc;
      padding: 3px 0;
      margin-bottom: 1px;
      width: 100%;
      display: flex;
      align-items: center;
      transition: background-color 0.3s, border 0.3s;
    }
    body.dark-mode #toolbar {
      background-color: #1e1e1e;
      border-color: #333;
    }
    body.dark-mode #toolbar svg,
    body.dark-mode #toolbar button.icon svg {
      fill: #e0e0e0 !important;
    }
    body.dark-mode #toolbar svg path {
      fill: #e0e0e0 !important;
    }
    #toolbar button.icon {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 10px;
      padding: 0;
      background: none;
      border: none;
      cursor: pointer;
      height: 40px;
    }
    #toolbar button.icon svg {
      display: block;
      margin: auto;
    }
    /* Terminal styling */
    #terminal {
      width: 100%;
      height: 200px;
      background: #121212;
      color: #00ff00;
      padding: 10px;
      border-radius: 5px;
      overflow-y: auto;
      white-space: pre-wrap;
      font-family: 'Courier New', Courier, monospace;
      display: none;
      margin-top: 1px;
      position: relative;
    }
    /* In dark mode krijgt de terminal een lichtere achtergrond maar blijft donker */
    body.dark-mode #terminal {
      background: #1e1e1e;
    }
    /* Blinkende cursor op de laatste regel van de terminal */
    #terminal::after {
      content: "_";
      animation: blink 1s step-end infinite;
    }
    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0; }
    }
    button.normal {
      background-color: #007bff;
      color: #fff;
      border: none;
      border-radius: 5px;
      margin: 10px 0;
      padding: 10px 20px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    body.dark-mode button.normal {
      background-color: #555;
    }
    /* Dark mode toggle: fixed rechtsboven */
    #darkModeToggle {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1001;
      background: none;
      border: none;
      cursor: pointer;
      padding: 5px;
      transition: fill 0.3s;
    }
    #darkModeToggle svg {
      width: 24px;
      height: 24px;
      fill: #007bff;
      transition: fill 0.3s;
    }
    body.dark-mode #darkModeToggle svg {
      fill: #e0e0e0;
    }
    #submit-container {
      text-align: left;
      margin-top: 10px;
    }
    /* Input Modal styling, nu met dezelfde knopstijl */
    #inputModal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }
    #inputModal input {
      width: 80%;
    }
    #inputModal button.normal {
      margin-top: 10px;
    }
    body.dark-mode #inputModal {
      background: #333;
      color: #e0e0e0;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
</head>
<body>
  <!-- Laadanimatie -->
  <div id="loader">
    <div class="spinner"></div>
  </div>
  
  <!-- Applicatie-container (verborgen tot laden voltooid) -->
  <div id="main-container">
    <div id="header-container">
      <div id="header-text">
        <h1 id="page-title"></h1>
        <span id="difficulty">Moeilijkheid: Aspiring Developer</span>
        <br/>
        <br/>
        <img height="200" src="https://cdn.nos.nl/image/2020/12/23/701694/2560x1440a.jpg"/>
        <p id="assignment-description"></p>
      </div>
    </div>
    <!-- Dark mode toggle staat nu fixed rechtsboven -->
    <button id="darkModeToggle" title="Toggle Dark Mode">
      <svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
        <title>dark-mode-solid</title>
        <g id="Layer_2" data-name="Layer 2">
          <g id="Icons">
            <g>
              <rect width="48" height="48" fill="none"/>
              <g>
                <path d="M14,24A10,10,0,0,0,24,34V14A10,10,0,0,0,14,24Z"/>
                <path d="M24,2A22,22,0,1,0,46,24,21.9,21.9,0,0,0,24,2ZM6,24A18.1,18.1,0,0,1,24,6v8a10,10,0,0,1,0,20v8A18.1,18.1,0,0,1,6,24Z"/>
              </g>
            </g>
          </g>
        </g>
      </svg>
    </button>
    <div id="button-container">
      <button class="normal" onclick="toggleTerminal()" title="Toon of verberg de terminal">Ervaar hoe de applicatie moet werken</button>
    </div>
    <div id="terminal-container">
      <div id="toolbar" style="display: none;">
        <button id="runButton" class="icon" style="display: none;" onclick="runPythonCode()" title="Voer code uit">
          <svg height="24" width="24" version="1.1" xmlns="http://www.w3.org/2000/svg" 
               xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve">
            <style type="text/css">
              .st0 { fill: #000000; }
            </style>
            <g>
              <path class="st0" d="M256,0C114.625,0,0,114.625,0,256c0,141.374,114.625,256,256,256
                c141.374,0,256-114.626,256-256C512,114.625,397.374,0,256,0z M351.062,258.898l-144,85.945
                c-1.031,0.626-2.344,0.657-3.406,0.031c-1.031-0.594-1.687-1.702-1.687-2.937v-85.946v-85.946
                c0-1.218,0.656-2.343,1.687-2.938c1.062-0.609,2.375-0.578,3.406,0.031l144,85.962
                c1.031,0.586,1.641,1.718,1.641,2.89C352.703,257.187,352.094,258.297,351.062,258.898z"/>
            </g>
          </svg>
        </button>
        <button id="clearButton" class="icon" style="display: none;" onclick="clearTerminal()" title="Maak de terminal leeg">
          <svg width="24" height="24" viewBox="0 0 21 21" xmlns="http://www.w3.org/2000/svg">
            <g fill="none" fill-rule="evenodd" stroke="#000000" stroke-linecap="round" stroke-linejoin="round"
               transform="matrix(0 1 1 0 2.5 2.5)">
              <path d="m13 11 3 3v-6c0-3.36502327-2.0776-6.24479706-5.0200433-7.42656457
                -.9209869-.36989409-1.92670197-.57343543-2.9799567-.57343543
                -4.418278 0-8 3.581722-8 8s3.581722 8 8 8c1.48966767 0 3.4724708-.3698516 5.0913668-1.5380762"/>
              <path d="m5 5 6 6"/>
              <path d="m11 5-6 6"/>
            </g>
          </svg>
        </button>
      </div>
      <div id="terminal"></div>
    </div>
    <div id="submit-container">
      <button class="normal" onclick="submitAssignment()" title="Lever je opdracht in">Lever je opdracht in codegrade</button>
    </div>
  </div>
  
  <!-- Input Modal -->
  <div id="inputModal">
    <p id="msg">Voer een waarde in:</p>
    <input type="text" id="userInput">
    <button class="normal" onclick="submitInput()">OK</button>
  </div>
  
  <script>
    const pageTitle = "Forensische ICT Opdracht";
    const opdrachtBeschrijving = `
Je wilt een stukje geheime informatie naar het openbaar ministerie sturen. 
    Je besluit dit te doen door je string te versleutelen met de Caesar versleuteling. 
    Door elke ASCII waarde van elke karakter met een getal (de sleutel) op te hogen.
    Maak een python programma die een string vraagt en een sleutel. Geef vervolgens de versleutelde string
    `;
    document.title = pageTitle;
    document.getElementById("page-title").innerText = pageTitle;
    document.getElementById("assignment-description").innerText = opdrachtBeschrijving;
    
    const applicatie_naam = "Opdracht1";
    const pythonCode = `
    woordje = input("Welk woordje wil je versleutelen? ")
    sleutel = int(input("Welke sleutel wil je gebruiken? "))
    cipher = ""
    for i in woordje:
        cipher += chr(ord(i) + sleutel)
    print(f"De versleuteling van {woordje} is {cipher}")
    `;
    let inputResolver, pyodide;
  
    const terminal = document.getElementById("terminal");
    const msg_modal = document.getElementById("msg");
    const inputModal = document.getElementById("inputModal");
    const userInput = document.getElementById("userInput");
    const runButton = document.getElementById("runButton");
    const clearButton = document.getElementById("clearButton");
    const toolbar = document.getElementById("toolbar");
    const darkModeToggle = document.getElementById("darkModeToggle");
    const mainContainer = document.getElementById("main-container");
    const loader = document.getElementById("loader");
  
    function preprocess_code(code) {
      return code.replace('input(', ' await input(').replace('(input(', ' (await input(');
    }
  
    function clearTerminal() {
      terminal.innerHTML = "";
    }
  
    async function loadPyodideAndSetup() {
      pyodide = await loadPyodide();
      terminal.innerHTML += `C:/${applicatie_naam}/main.py\n`;
      pyodide.globals.set('input', s => getInputFromUser(s));
      pyodide.globals.set('print', s => {
        terminal.innerHTML += `${s}\n`;
      });
    }
  
    async function runPythonCode() {
      terminal.innerHTML += `python C:/${applicatie_naam}/main.py\n`;
      if (!pyodide) {
        terminal.innerHTML += ` ${applicatie_naam} is nog niet geladen...\n`;
        return;
      }
      try {
        await pyodide.runPythonAsync(preprocess_code(pythonCode));
      } catch (error) {
        terminal.innerHTML += "Fout: " + error + "\n";
      }
    }
  
    function getInputFromUser(promptText) {
      terminal.innerHTML += `> ${promptText}`;
      msg_modal.innerHTML = promptText;
      return new Promise((resolve) => {
        inputModal.style.display = "block";
        inputResolver = resolve;
        userInput.focus();
      });
    }
  
    function submitInput() {
      inputModal.style.display = "none";
      const inputValue = userInput.value;
      terminal.innerHTML += `<i>${inputValue}\n</i>`;
      userInput.value = "";
      inputResolver(inputValue);
    }
  
    userInput.addEventListener("keydown", (event) => {
      if (event.key === "Enter") {
        submitInput();
      }
    });
  
    function toggleTerminal() {
      const isVisible = window.getComputedStyle(terminal).display !== "none";
      if (isVisible) {
        terminal.style.display = "none";
        toolbar.style.display = "none";
        runButton.style.display = "none";
        clearButton.style.display = "none";
      } else {
        terminal.style.display = "block";
        toolbar.style.display = "flex";
        runButton.style.display = "inline-block";
        clearButton.style.display = "inline-block";
      }
    }
  
    function submitAssignment() {
      window.open("https://voorbeeldwebsite.com/leverin", "_blank");
    }
    if (sessionStorage.getItem("darkMode") === "true") {
        document.body.classList.add("dark-mode");
    } else {
        document.body.classList.remove("dark-mode");
    }
    window.onload = () => {
      loadPyodideAndSetup().then(() => {
        loader.style.display = "none";
        mainContainer.style.display = "block";
      });
    };
  
    darkModeToggle.addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
      sessionStorage.setItem("darkMode", document.body.classList.contains("dark-mode"));
    });
  </script>
</body>
</html>
